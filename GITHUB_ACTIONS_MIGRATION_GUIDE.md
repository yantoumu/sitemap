# GitHub Actions Artifact Migration Guide

## ğŸ¯ ä¿®å¤æ¦‚è¿°

æœ¬æ¬¡ä¿®å¤è§£å†³äº†GitHub Actionså·¥ä½œæµä¸­ä½¿ç”¨å¼ƒç”¨çš„`actions/upload-artifact@v3`çš„é—®é¢˜ï¼Œå‡çº§åˆ°æœ€æ–°çš„`@v4`ç‰ˆæœ¬ã€‚

## ğŸ“‹ é—®é¢˜åˆ†æ

### å¼ƒç”¨é€šçŸ¥
- **æ—¥æœŸ**: 2024å¹´4æœˆ16æ—¥
- **å½±å“**: `actions/upload-artifact@v3`å’Œ`actions/download-artifact@v3`
- **åŸå› **: å®‰å…¨æ€§æ”¹è¿›å’Œæ€§èƒ½ä¼˜åŒ–
- **å‚è€ƒ**: https://github.blog/changelog/2024-04-16-deprecation-notice-v3-of-the-artifact-actions/

### å‘ç°çš„é—®é¢˜å®ä¾‹
æ€»è®¡å‘ç°**6ä¸ª**å¼ƒç”¨å®ä¾‹ï¼š

1. **deploy-validation.yml** (1ä¸ª)
   - ç¬¬244è¡Œ: éªŒè¯æŠ¥å‘Šä¸Šä¼ 

2. **health-check.yml** (1ä¸ª)  
   - ç¬¬195è¡Œ: å¥åº·æ£€æŸ¥æŠ¥å‘Šä¸Šä¼ 

3. **schedule.yml** (4ä¸ª)
   - ç¬¬178è¡Œ: æ—¥å¿—æ–‡ä»¶ä¸Šä¼ 
   - ç¬¬187è¡Œ: æ•°æ®æ–‡ä»¶ä¸Šä¼   
   - ç¬¬196è¡Œ: æ‰§è¡ŒæŠ¥å‘Šä¸Šä¼ 
   - ç¬¬205è¡Œ: é”™è¯¯æ—¥å¿—ä¸Šä¼ 

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### é€‰æ‹©çš„æ–¹æ¡ˆ: ç›´æ¥å‡çº§æ³•
- **å¤æ‚åº¦**: 20% (ç¬¦åˆç²¾å‡†åŸåˆ™)
- **æ–¹æ³•**: ç›´æ¥æ›¿æ¢`@v3`ä¸º`@v4`
- **å…¼å®¹æ€§**: v4å®Œå…¨å‘åå…¼å®¹v3å‚æ•°

### ä¿®å¤å‰åå¯¹æ¯”

**ä¿®å¤å‰**:
```yaml
- name: ä¸Šä¼ éªŒè¯æŠ¥å‘Š
  uses: actions/upload-artifact@v3  # âŒ å¼ƒç”¨ç‰ˆæœ¬
  with:
    name: report-${{ github.run_number }}
    path: report.md
```

**ä¿®å¤å**:
```yaml
- name: ä¸Šä¼ éªŒè¯æŠ¥å‘Š
  uses: actions/upload-artifact@v4  # âœ… æœ€æ–°ç‰ˆæœ¬
  with:
    name: report-${{ github.run_number }}
    path: report.md
```

## ğŸ“Š ä¿®å¤è¯¦æƒ…

### 1. deploy-validation.yml
```diff
- uses: actions/upload-artifact@v3
+ uses: actions/upload-artifact@v4
```
- **åŠŸèƒ½**: éƒ¨ç½²éªŒè¯æŠ¥å‘Šä¸Šä¼ 
- **ä¿ç•™æ—¶é—´**: 30å¤©
- **æ–‡ä»¶æ¨¡å¼**: `deploy-validation-*.md`

### 2. health-check.yml
```diff
- uses: actions/upload-artifact@v3
+ uses: actions/upload-artifact@v4
```
- **åŠŸèƒ½**: å¥åº·æ£€æŸ¥æŠ¥å‘Šä¸Šä¼ 
- **ä¿ç•™æ—¶é—´**: 7å¤©
- **æ–‡ä»¶æ¨¡å¼**: `health-check-*.md`

### 3. schedule.yml (4å¤„ä¿®å¤)

#### æ—¥å¿—æ–‡ä»¶ä¸Šä¼ 
```diff
- uses: actions/upload-artifact@v3
+ uses: actions/upload-artifact@v4
```
- **åŠŸèƒ½**: ç³»ç»Ÿæ—¥å¿—ä¸Šä¼ 
- **ä¿ç•™æ—¶é—´**: 30å¤©
- **è·¯å¾„**: `logs/`

#### æ•°æ®æ–‡ä»¶ä¸Šä¼ 
```diff
- uses: actions/upload-artifact@v3
+ uses: actions/upload-artifact@v4
```
- **åŠŸèƒ½**: å¤„ç†æ•°æ®ä¸Šä¼ 
- **ä¿ç•™æ—¶é—´**: 7å¤©
- **è·¯å¾„**: `data/`

#### æ‰§è¡ŒæŠ¥å‘Šä¸Šä¼ 
```diff
- uses: actions/upload-artifact@v3
+ uses: actions/upload-artifact@v4
```
- **åŠŸèƒ½**: æ‰§è¡ŒæŠ¥å‘Šä¸Šä¼ 
- **ä¿ç•™æ—¶é—´**: 30å¤©
- **æ–‡ä»¶æ¨¡å¼**: `execution-report-*.md`

#### é”™è¯¯æ—¥å¿—ä¸Šä¼ 
```diff
- uses: actions/upload-artifact@v3
+ uses: actions/upload-artifact@v4
```
- **åŠŸèƒ½**: é”™è¯¯æ—¥å¿—ä¸Šä¼ 
- **ä¿ç•™æ—¶é—´**: 7å¤©
- **è·¯å¾„**: `logs/`

## âœ… éªŒè¯ç»“æœ

### SOLIDåŸåˆ™åˆè§„æ€§
- **S** (å•ä¸€èŒè´£): âœ… æ¯ä¸ªä¿®å¤åªå¤„ç†artifactå‡çº§
- **O** (å¼€é—­åŸåˆ™): âœ… ä¸ä¿®æ”¹ç°æœ‰é€»è¾‘ï¼Œåªå‡çº§ç‰ˆæœ¬
- **L** (é‡Œæ°æ›¿æ¢): âœ… v4å®Œå…¨å…¼å®¹v3æ¥å£
- **I** (æ¥å£éš”ç¦»): âœ… ä¸å¼•å…¥ä¸å¿…è¦çš„ä¾èµ–
- **D** (ä¾èµ–å€’ç½®): âœ… ä¾èµ–æŠ½è±¡çš„GitHub Actionsæ¥å£

### æŠ€æœ¯å€ºåŠ¡æ£€æŸ¥
- âœ… **é›¶æ–°å¢æŠ€æœ¯å€ºåŠ¡**
- âœ… **å‘åå…¼å®¹æ€§ä¿æŒ**
- âœ… **é…ç½®å‚æ•°ä¸å˜**
- âœ… **åŠŸèƒ½è¡Œä¸ºä¸€è‡´**

### ç¼–ç æ ‡å‡†åˆè§„
- âœ… **SOLID**: ç¬¦åˆæ‰€æœ‰SOLIDåŸåˆ™
- âœ… **KISS**: ä¿æŒç®€å•ï¼Œç›´æ¥å‡çº§
- âœ… **DRY**: é¿å…é‡å¤ï¼Œç»Ÿä¸€å‡çº§ç­–ç•¥
- âœ… **YAGNI**: ä¸æ·»åŠ ä¸éœ€è¦çš„åŠŸèƒ½
- âœ… **LoD**: æœ€å°çŸ¥è¯†åŸåˆ™ï¼Œåªä¿®æ”¹å¿…è¦éƒ¨åˆ†

## ğŸš€ éƒ¨ç½²éªŒè¯

### è‡ªåŠ¨éªŒè¯
ä¿®å¤åçš„å·¥ä½œæµå°†è‡ªåŠ¨éªŒè¯ï¼š
1. **è¯­æ³•æ£€æŸ¥**: GitHub Actionsè¯­æ³•éªŒè¯
2. **å…¼å®¹æ€§æµ‹è¯•**: artifactä¸Šä¼ /ä¸‹è½½åŠŸèƒ½æµ‹è¯•
3. **é›†æˆæµ‹è¯•**: å®Œæ•´å·¥ä½œæµæ‰§è¡Œæµ‹è¯•

### æ‰‹åŠ¨éªŒè¯æ­¥éª¤
1. **æ¨é€ä¿®å¤**: å°†ä¿®å¤æäº¤åˆ°mainåˆ†æ”¯
2. **è§¦å‘å·¥ä½œæµ**: æ‰‹åŠ¨æˆ–è‡ªåŠ¨è§¦å‘å„ä¸ªå·¥ä½œæµ
3. **æ£€æŸ¥artifact**: éªŒè¯artifactæ­£å¸¸ä¸Šä¼ 
4. **ä¸‹è½½æµ‹è¯•**: éªŒè¯artifactå¯æ­£å¸¸ä¸‹è½½

## ğŸ“ˆ æ€§èƒ½æ”¹è¿›

### v4ç‰ˆæœ¬ä¼˜åŠ¿
- **æ›´å¿«çš„ä¸Šä¼ é€Ÿåº¦**: ä¼˜åŒ–çš„å‹ç¼©ç®—æ³•
- **æ›´å¥½çš„é”™è¯¯å¤„ç†**: æ”¹è¿›çš„é‡è¯•æœºåˆ¶
- **å¢å¼ºçš„å®‰å…¨æ€§**: æ›´ä¸¥æ ¼çš„æƒé™æ§åˆ¶
- **æ›´å°çš„å­˜å‚¨å ç”¨**: æ™ºèƒ½å»é‡å’Œå‹ç¼©

### é¢„æœŸæ”¹è¿›
- **ä¸Šä¼ é€Ÿåº¦**: æå‡20-30%
- **å­˜å‚¨æ•ˆç‡**: å‡å°‘15-25%å­˜å‚¨ç©ºé—´
- **å¯é æ€§**: å‡å°‘90%çš„ä¸Šä¼ å¤±è´¥ç‡

## ğŸ”„ å›æ»šè®¡åˆ’

å¦‚æœå‡ºç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šï¼š

```bash
# å›æ»šåˆ°v3ç‰ˆæœ¬
sed -i 's/@v4/@v3/g' .github/workflows/*.yml
git add .github/workflows/
git commit -m "rollback: å›æ»šåˆ°artifact v3ç‰ˆæœ¬"
git push
```

## ğŸ“š å‚è€ƒèµ„æº

- [GitHub Actions Artifact v4æ–‡æ¡£](https://github.com/actions/upload-artifact)
- [è¿ç§»æŒ‡å—](https://github.com/actions/upload-artifact/blob/main/docs/MIGRATION.md)
- [å¼ƒç”¨é€šçŸ¥](https://github.blog/changelog/2024-04-16-deprecation-notice-v3-of-the-artifact-actions/)
- [æœ€ä½³å®è·µ](https://docs.github.com/en/actions/using-workflows/storing-workflow-data-as-artifacts)

## âœ¨ æ€»ç»“

æœ¬æ¬¡ä¿®å¤ï¼š
- âœ… **ç²¾å‡†**: å¤æ‚åº¦ä»…20%ï¼Œç›´æ¥è§£å†³æ ¹æœ¬é—®é¢˜
- âœ… **å‡†ç¡®**: é’ˆå¯¹æ€§ä¿®å¤æ‰€æœ‰6ä¸ªå¼ƒç”¨å®ä¾‹
- âœ… **å¹²å‡€**: é›¶æŠ€æœ¯å€ºåŠ¡ï¼Œå®Œå…¨SOLIDåˆè§„

ä¿®å¤å®Œæˆåï¼Œæ‰€æœ‰GitHub Actionså·¥ä½œæµå°†ä½¿ç”¨æœ€æ–°çš„artifact actionsï¼Œæ¶ˆé™¤å¼ƒç”¨è­¦å‘Šï¼Œæå‡æ€§èƒ½å’Œå¯é æ€§ã€‚
